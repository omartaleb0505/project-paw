<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Attendance System</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(145deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100%;
            color: #e2e8f0;
        }

        html { height: 100%; }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Navigation */
        .navbar {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border: 1px solid rgba(148, 163, 184, 0.2);
            padding: 1.5rem 2rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .nav-brand {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #06b6d4, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .nav-links {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .nav-link {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #374151 0%, #4b5563 100%);
            color: #f1f5f9;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
        }

        /* Content Sections */
        .content-section {
            display: none;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border: 1px solid rgba(148, 163, 184, 0.2);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            margin-bottom: 2rem;
        }

        .content-section.active {
            display: block;
        }

        .section-title {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #06b6d4, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 2rem;
            text-align: center;
        }

        /* Forms */
        .form-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #cbd5e1;
        }

        .form-input {
            width: 100%;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid rgba(148, 163, 184, 0.3);
            border-radius: 12px;
            color: #f1f5f9;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #06b6d4;
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.1);
        }

        .error-message {
            color: #f87171;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none;
            padding: 0.5rem;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 8px;
        }

        .submit-btn, .report-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            color: white;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(6, 182, 212, 0.3);
        }

        .report-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            margin-bottom: 1rem;
        }

        .report-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-bottom: 2rem;
            background: rgba(15, 23, 42, 0.5);
            padding: 1rem;
            border-radius: 16px;
        }

        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            background: transparent;
        }

        .attendance-table th {
            background: linear-gradient(135deg, #374151 0%, #4b5563 100%);
            color: #f1f5f9;
            padding: 1rem 0.5rem;
            text-align: center;
            font-weight: 700;
            font-size: 0.875rem;
        }

        .attendance-table td {
            padding: 0.75rem 0.5rem;
            text-align: center;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
            color: #cbd5e1;
        }

        .clickable-cell {
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(30, 41, 59, 0.3) !important;
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .clickable-cell:hover {
            background: rgba(6, 182, 212, 0.2) !important;
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(6, 182, 212, 0.3);
        }

        .delete-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            transform: translateY(-1px);
        }

        .good-attendance td {
            background: rgba(34, 197, 94, 0.2) !important;
            color: #86efac !important;
        }

        .warning-attendance td {
            background: rgba(251, 191, 36, 0.2) !important;
            color: #fde047 !important;
        }

        .poor-attendance td {
            background: rgba(239, 68, 68, 0.2) !important;
            color: #fca5a5 !important;
        }

        /* Messages & Reports */
        .success-message {
            background: rgba(34, 197, 94, 0.2);
            color: #86efac;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            display: none;
            text-align: center;
        }

        .report-results {
            display: none;
            background: rgba(15, 23, 42, 0.5);
            padding: 1.5rem;
            border-radius: 16px;
        }

        .report-results h3 {
            color: #f1f5f9;
            margin-bottom: 1rem;
            text-align: center;
        }

        .report-item {
            margin-bottom: 0.75rem;
            padding: 0.75rem;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 8px;
            border-left: 3px solid #10b981;
        }

        .report-number {
            font-weight: bold;
            color: #86efac;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 15px; }
            .nav-link { padding: 0.5rem 1rem; font-size: 0.85rem; }
            .section-title { font-size: 1.8rem; }
            .content-section { padding: 1.5rem; }
            .attendance-table th, .attendance-table td { padding: 0.5rem 0.25rem; font-size: 0.75rem; }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container"><!-- Navigation Bar -->
   <nav class="navbar">
    <div class="nav-brand" id="systemTitle">
     Student Attendance System
    </div>
    <div class="nav-links"><button class="nav-link active" onclick="showSection('home')">Home</button> <button class="nav-link" onclick="showSection('attendance')">Attendance List</button> <button class="nav-link" onclick="showSection('add-student')">Add Student</button> <button class="nav-link" onclick="showSection('reports')">Reports</button> <button class="nav-link" onclick="logout()">Logout</button>
    </div>
   </nav><!-- Home Section -->
   <div id="home" class="content-section active">
    <h1 class="section-title">Welcome to the Attendance System</h1>
    <div style="text-align: center; color: #4a5568;">
     <p><strong id="universityName">Algiers University Benyoucef Benkhedda</strong></p>
     <p>Faculty of Science - Department of Computer Science</p>
     <p><strong>Course:</strong> <span id="courseName">Advanced Web Programming</span></p>
     <p><strong>Level:</strong> 3rd year Computer Science degree (ISIL)</p>
     <p><strong>Academic year:</strong> 2025/2026</p>
    </div>
   </div><!-- Attendance List Section -->
   <div id="attendance" class="content-section">
    <h2 class="section-title">Student Attendance</h2>
    <div style="margin-bottom: 1rem; text-align: center; color: #cbd5e1;">
     <p>Click on attendance (S) or participation (P) cells to toggle ✓/✗</p>
    </div>
    <div class="table-container">
     <table class="attendance-table" id="attendanceTable">
      <thead>
       <tr>
        <th>Student ID</th>
        <th>Last Name</th>
        <th>First Name</th>
        <th>Email</th>
        <th>S1</th>
        <th>P1</th>
        <th>S2</th>
        <th>P2</th>
        <th>S3</th>
        <th>P3</th>
        <th>S4</th>
        <th>P4</th>
        <th>S5</th>
        <th>P5</th>
        <th>S6</th>
        <th>P6</th>
        <th>Absences</th>
        <th>Participation</th>
        <th>Message</th>
        <th>Actions</th>
       </tr>
      </thead>
      <tbody id="attendanceBody"><!-- Sample data will be populated by JavaScript -->
      </tbody>
     </table>
    </div>
    <div class="report-container"><button class="report-btn" onclick="generateReport()">Show Report</button>
     <div class="report-results" id="reportResults">
      <h3>Attendance Report</h3>
      <div class="report-item">
       Total Students: <span class="report-number" id="totalStudents">0</span>
      </div>
      <div class="report-item">
       Students Present (Latest Session): <span class="report-number" id="studentsPresent">0</span>
      </div>
      <div class="report-item">
       Students Participated (Latest Session): <span class="report-number" id="studentsParticipated">0</span>
      </div>
      <div class="report-item">
       Average Attendance Rate: <span class="report-number" id="attendanceRate">0%</span>
      </div>
     </div>
    </div>
   </div><!-- Add Student Section -->
   <div id="add-student" class="content-section">
    <h2 class="section-title">Add New Student</h2>
    <div class="success-message" id="successMessage">
     Student added successfully!
    </div>
    <div class="form-container">
     <form id="studentForm" onsubmit="addStudent(event)">
      <div class="form-group"><label for="studentId" class="form-label">Student ID</label> <input type="text" id="studentId" class="form-input" placeholder="Enter student ID">
       <div class="error-message" id="studentIdError">
        Student ID must contain only numbers
       </div>
      </div>
      <div class="form-group"><label for="lastName" class="form-label">Last Name</label> <input type="text" id="lastName" class="form-input" placeholder="Enter last name">
       <div class="error-message" id="lastNameError">
        Last name must contain only letters
       </div>
      </div>
      <div class="form-group"><label for="firstName" class="form-label">First Name</label> <input type="text" id="firstName" class="form-input" placeholder="Enter first name">
       <div class="error-message" id="firstNameError">
        First name must contain only letters
       </div>
      </div>
      <div class="form-group"><label for="email" class="form-label">Email</label> <input type="email" id="email" class="form-input" placeholder="Enter email address">
       <div class="error-message" id="emailError">
        Please enter a valid email address
       </div>
      </div><button type="submit" class="submit-btn">Add Student</button>
     </form>
    </div>
   </div><!-- Reports Section -->
   <div id="reports" class="content-section">
    <h2 class="section-title">Detailed Reports</h2>
    <div class="report-container"><button class="report-btn" onclick="generateDetailedReport()">Generate Detailed Report</button>
     <div class="report-results" id="detailedReportResults">
      <h3>Comprehensive Attendance Analysis</h3>
      <div id="detailedReportContent"><!-- Detailed report content will be generated here -->
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Sample student data
        let students = [
            {
                id: "001",
                lastName: "Ahmed",
                firstName: "Sara",
                email: "sara.ahmed@university.dz",
                sessions: [false, true, false, true, false, true], // false = absent, true = present
                participation: [false, true, false, false, false, true] // false = no participation, true = participated
            },
            {
                id: "002",
                lastName: "Yacine",
                firstName: "Ali",
                email: "ali.yacine@university.dz",
                sessions: [true, true, true, true, true, false],
                participation: [true, true, false, true, true, false]
            },
            {
                id: "003",
                lastName: "Houcine",
                firstName: "Rania",
                email: "rania.houcine@university.dz",
                sessions: [true, true, false, false, true, true],
                participation: [false, true, false, false, true, false]
            }
        ];

        // Configuration object for editable features
        const defaultConfig = {
            system_title: "Student Attendance System",
            course_name: "Advanced Web Programming",
            university_name: "Algiers University Benyoucef Benkhedda"
        };

        // Initialize the page
        function initializePage() {
            populateAttendanceTable();
            calculateAttendanceStats();
        }

        // Show specific section
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Remove active class from all nav links
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked nav link
            event.target.classList.add('active');
        }

        // Populate attendance table
        function populateAttendanceTable() {
            const tbody = document.getElementById('attendanceBody');
            tbody.innerHTML = '';
            
            students.forEach((student, index) => {
                const row = createStudentRow(student, index);
                tbody.appendChild(row);
            });
        }

        // Create student row
        function createStudentRow(student, index) {
            const row = document.createElement('tr');
            
            // Calculate absences and participation
            const absences = student.sessions.filter(session => !session).length;
            const participations = student.participation.filter(p => p).length;
            
            // Determine row color based on absences
            let rowClass = '';
            let message = '';
            
            if (absences < 3) {
                rowClass = 'good-attendance';
                message = participations >= 4 ? 'Good attendance – Excellent participation' : 'Good attendance – You need to participate more';
            } else if (absences <= 4) {
                rowClass = 'warning-attendance';
                message = 'Warning – attendance low – You need to participate more';
            } else {
                rowClass = 'poor-attendance';
                message = 'Excluded – too many absences – You need to participate more';
            }
            
            row.className = rowClass;
            
            // Build row HTML
            let rowHTML = `
                <td>${student.id}</td>
                <td>${student.lastName}</td>
                <td>${student.firstName}</td>
                <td>${student.email}</td>
            `;
            
            // Add interactive session and participation columns
            for (let i = 0; i < 6; i++) {
                rowHTML += `<td class="clickable-cell" onclick="toggleAttendance(${index}, ${i}, 'session')">${student.sessions[i] ? '✓' : '✗'}</td>`;
                rowHTML += `<td class="clickable-cell" onclick="toggleAttendance(${index}, ${i}, 'participation')">${student.participation[i] ? '✓' : '✗'}</td>`;
            }
            
            rowHTML += `
                <td>${absences} Abs</td>
                <td>${participations} Par</td>
                <td>${message}</td>
                <td><button class="delete-btn" onclick="deleteStudent(${index})">Delete</button></td>
            `;
            
            row.innerHTML = rowHTML;
            return row;
        }

        // Toggle attendance or participation
        function toggleAttendance(studentIndex, sessionIndex, type) {
            if (type === 'session') {
                students[studentIndex].sessions[sessionIndex] = !students[studentIndex].sessions[sessionIndex];
            } else if (type === 'participation') {
                students[studentIndex].participation[sessionIndex] = !students[studentIndex].participation[sessionIndex];
            }
            
            // Refresh the table
            populateAttendanceTable();
        }

        // Delete student
        function deleteStudent(studentIndex) {
            if (confirm(`Are you sure you want to delete ${students[studentIndex].firstName} ${students[studentIndex].lastName}?`)) {
                students.splice(studentIndex, 1);
                populateAttendanceTable();
            }
        }

        // Form validation
        function validateForm() {
            let isValid = true;
            
            // Validate Student ID
            const studentId = document.getElementById('studentId').value;
            const studentIdError = document.getElementById('studentIdError');
            if (!studentId || !/^\d+$/.test(studentId)) {
                studentIdError.style.display = 'block';
                isValid = false;
            } else {
                studentIdError.style.display = 'none';
            }
            
            // Validate Last Name
            const lastName = document.getElementById('lastName').value;
            const lastNameError = document.getElementById('lastNameError');
            if (!lastName || !/^[a-zA-Z\s]+$/.test(lastName)) {
                lastNameError.style.display = 'block';
                isValid = false;
            } else {
                lastNameError.style.display = 'none';
            }
            
            // Validate First Name
            const firstName = document.getElementById('firstName').value;
            const firstNameError = document.getElementById('firstNameError');
            if (!firstName || !/^[a-zA-Z\s]+$/.test(firstName)) {
                firstNameError.style.display = 'block';
                isValid = false;
            } else {
                firstNameError.style.display = 'none';
            }
            
            // Validate Email
            const email = document.getElementById('email').value;
            const emailError = document.getElementById('emailError');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email || !emailRegex.test(email)) {
                emailError.style.display = 'block';
                isValid = false;
            } else {
                emailError.style.display = 'none';
            }
            
            return isValid;
        }

        // Add student function
        function addStudent(event) {
            event.preventDefault();
            
            if (!validateForm()) {
                return;
            }
            
            // Get form values
            const studentId = document.getElementById('studentId').value;
            const lastName = document.getElementById('lastName').value;
            const firstName = document.getElementById('firstName').value;
            const email = document.getElementById('email').value;
            
            // Check if student ID already exists
            if (students.some(student => student.id === studentId)) {
                document.getElementById('studentIdError').textContent = 'Student ID already exists';
                document.getElementById('studentIdError').style.display = 'block';
                return;
            }
            
            // Create new student object
            const newStudent = {
                id: studentId,
                lastName: lastName,
                firstName: firstName,
                email: email,
                sessions: [false, false, false, false, false, false], // All sessions initially absent
                participation: [false, false, false, false, false, false] // No participation initially
            };
            
            // Add to students array
            students.push(newStudent);
            
            // Update attendance table
            populateAttendanceTable();
            
            // Show success message
            const successMessage = document.getElementById('successMessage');
            successMessage.style.display = 'block';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
            
            // Reset form
            document.getElementById('studentForm').reset();
            
            // Hide all error messages
            document.querySelectorAll('.error-message').forEach(error => {
                error.style.display = 'none';
            });
        }

        // Calculate attendance statistics
        function calculateAttendanceStats() {
            // This function can be called to update any real-time stats
        }

        // Generate report
        function generateReport() {
            const totalStudents = students.length;
            let studentsPresent = 0;
            let studentsParticipated = 0;
            let totalAttendanceRate = 0;
            
            students.forEach(student => {
                // Check latest session (session 6, index 5)
                if (student.sessions[5]) studentsPresent++;
                if (student.participation[5]) studentsParticipated++;
                
                // Calculate individual attendance rate
                const attendanceCount = student.sessions.filter(session => session).length;
                totalAttendanceRate += (attendanceCount / 6) * 100;
            });
            
            const averageAttendanceRate = totalStudents > 0 ? (totalAttendanceRate / totalStudents).toFixed(1) : 0;
            
            // Update report display
            document.getElementById('totalStudents').textContent = totalStudents;
            document.getElementById('studentsPresent').textContent = studentsPresent;
            document.getElementById('studentsParticipated').textContent = studentsParticipated;
            document.getElementById('attendanceRate').textContent = averageAttendanceRate + '%';
            
            // Show report results
            document.getElementById('reportResults').style.display = 'block';
        }

        // Generate detailed report
        function generateDetailedReport() {
            let reportHTML = '';
            
            students.forEach(student => {
                const absences = student.sessions.filter(session => !session).length;
                const participations = student.participation.filter(p => p).length;
                const attendanceRate = ((6 - absences) / 6 * 100).toFixed(1);
                
                reportHTML += `
                    <div style="margin-bottom: 1rem; padding: 1rem; background: white; border-radius: 8px; border-left: 4px solid #667eea;">
                        <strong>${student.firstName} ${student.lastName} (ID: ${student.id})</strong><br>
                        Attendance Rate: ${attendanceRate}% | Absences: ${absences} | Participations: ${participations}<br>
                        Email: ${student.email}
                    </div>
                `;
            });
            
            document.getElementById('detailedReportContent').innerHTML = reportHTML;
            document.getElementById('detailedReportResults').style.display = 'block';
        }

        // Logout function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // In a real application, this would redirect to login page
                showSection('home');
            }
        }

        // Add real-time validation listeners
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = ['studentId', 'lastName', 'firstName', 'email'];
            inputs.forEach(inputId => {
                document.getElementById(inputId).addEventListener('input', validateForm);
            });
            
            initializePage();
        });

        // Element SDK Configuration
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig: defaultConfig,
                onConfigChange: async (config) => {
                    document.getElementById('systemTitle').textContent = config.system_title || defaultConfig.system_title;
                    document.getElementById('courseName').textContent = config.course_name || defaultConfig.course_name;
                    document.getElementById('universityName').textContent = config.university_name || defaultConfig.university_name;
                },
                mapToCapabilities: (config) => ({
                    recolorables: [],
                    borderables: [],
                    fontEditable: undefined,
                    fontSizeable: undefined
                }),
                mapToEditPanelValues: (config) => new Map([
                    ["system_title", config.system_title || defaultConfig.system_title],
                    ["course_name", config.course_name || defaultConfig.course_name],
                    ["university_name", config.university_name || defaultConfig.university_name]
                ])
            });
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99e93118871f2822',t:'MTc2MzE1MTQ0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
